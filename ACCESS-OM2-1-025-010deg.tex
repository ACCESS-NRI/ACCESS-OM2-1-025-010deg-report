%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% This will not run without gitinfo2 git hooks set up
% see https://ctan.org/pkg/gitinfo2
% This should work automatically if this file is obtained via
% git clone -- TODO: check and finish!
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[11pt]{article}
\usepackage{geometry}                % See geometry.pdf to learn the layout options. There are lots.
\geometry{a4paper}                   % ... or a4paper or a5paper or ... 
%\geometry{landscape}                % Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    % Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}
\usepackage{amssymb}
%\usepackage{epstopdf}
%\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}

\usepackage{ifthen}
\usepackage[a4paper,colorlinks,
linkcolor={blue},citecolor={blue},pagecolor={blue},urlcolor={blue},
 breaklinks, bookmarks, bookmarksopen, bookmarksnumbered
]{hyperref}
\usepackage{url}\urlstyle{sf} % rm, sf, tt or same
\usepackage{datetime2}
\usepackage[grumpy]{gitinfo2}
\DTMsetdatestyle{iso}
\usepackage{natbib}
\usepackage{longtable}
\usepackage{sistyle}
\usepackage{array}

\newcommand{\note}[1]{#1} % show all notes
%\newcommand{\note}[1]{\quad}     % hide all notes
\newcommand{\TODO}[1]{\note{\textcolor{blue}{\textsf{\textbf{TODO: #1}}}}}
\newcommand{\FIXME}[1]{\note{\textcolor{red}{\textsf{\textbf{FIXME: #1}}}}}

\title{ACCESS-OM2: The Australian Community Climate and Earth-System Simulator Ocean Model 2}
\author{Andrew Kiss, Andy Hogg, Paul Spence, Fanghua Wu, Kial Stewart,\\ Stephen Griffies, Nicholas Hannah, Russell Fiedler, Aidan Heerdegen,\\
Matthew England, Adele Morrison}
\date{\textsf{The latest version of this document is available from:\TODO{add link to github!}\\
\hfill{\footnotesize This version: typeset \today\ \DTMcurrenttime\ \DTMcurrentzone \\ 
\ifthenelse{\equal{\gitRoff}{}}{}{\hfill \gitRoff\ commit(s) since release \gitRel \\} 
\hfill Last commit%
\ifthenelse{\equal{\gitDirty}{}}{:}{ (\emph{didn't commit all tracked changes}):}
git hash: \gitAbbrevHash\ 
\gitCommitterIsoDate, \\\hfill committed to branch ``\gitBranch '' by \gitCommitterName\\
%\gitDirty\ 
%committed by \gitCommitterName , \gitCommitterIsoDate\ \\
\hfill\textbf{NB: git hash does not reflect any uncommitted changes to this document.}
\TODO{automatically warn if there are uncommitted changes - eg by \url{https://www.ctan.org/pkg/latexgit}}
\FIXME{is there any way include the pdf in the git repo and also have it show an up-to-date git hash?? --- see p12 of gitinfo2 documentation}}}\\
\raggedright{\vspace{10ex}
\TODO{use overleaf (with github integration? - \url{https://www.overleaf.com/blog/195-new-collaborate-online-and-offline-with-overleaf-and-git-beta}) rather than just git? - simpler for contributors}
\\
CONTRIBUTORS PLEASE NOTE:\\
\begin{itemize}
\item to make git diffs easier, please write each sentence on a separate line
\item add ``to do'' items using $\backslash$TODO\{\ldots\}
\item note errors and problems using $\backslash$FIXME\{\ldots\}
\item use a bare number (no leading v) if you do git tags (for compatibility with the gitinfo2 package used here)
\end{itemize}
}}

\begin{document}
\maketitle

\tableofcontents
\listoffigures


\section{Introduction}
This technical report documents the ACCESS-OM2 ocean-sea ice model at nominal horizontal resolutions of $1^\circ$, $0.25^\circ$ and $0.1^\circ$.

\section{Model Configuration}

\subsection{Overview}
MOM, CICE, OASIS, JRA55

cf.\ CORE \citep{GriffiesBiastochBoningBryanDanabasogluChassignetEnglandGerdesHaak2009a}, CORE-II \citep{DanabasogluYeagerBaileyBehrensBentsenBiBiastochBoningBozec2014a}

\subsection{MOM version and settings}
\TODO{auto-generate namelist table}

\subsection{Grid}
Discuss KDS vertical grid \citet{StewartHoggGriffiesHeerdegenWardSpenceEngland2017a}


\subsection{Bathymetry}
based on Gebco2014 30sec gridded data % located at /g/data3/hh5/tmp/cosima/bathymetry/gebco.nc
which exact version? \url{http://www.gebco.net/data_and_products/gridded_bathymetry_data/gebco_30_second_grid/}

\subsection{CICE}

\subsection{OASIS}

Nic's work on ESMF regridding


\subsection{Forcing}

JRA55 version

discuss choice of year for RYF

Regridding method

Runoff - incl distributed iceberg melt?

\subsection{Initial conditions and spinup}

\section{Model computational performance}

\section{Model evaluation}
 - do this via a cookbook that emits all needed pngs/pdfs 

\subsection{Global conservation and drift}

\subsubsection{Heat}

\subsubsection{Salt}

\subsubsection{Fresh water}

\subsubsection{Sea ice}


\subsection{Transports through key straits and boundary currents}

\subsection{Overturning}

\subsection{Water mass properties}

\subsection{EKE}

\subsection{Time-dependence, eg of WBCs}

\subsection{Sea ice - area, thickness, formation rate}

\appendix
\section{Auto-generated namelists}

% auto-generated by:
%nml_diff.py --format latex /Users/andy/Documents/COSIMA/github/aekiss/access-om2/control/*jra*/ocean/input.nml > ocean_nml.tex
%nml_diff.py --format latex /Users/andy/Documents/COSIMA/github/aekiss/access-om2/control/*jra*/atmosphere/input_atm.nml > atm_nml.tex
%nml_diff.py --format latex /Users/andy/Documents/COSIMA/github/aekiss/access-om2/control/*jra*/ice/input_ice.nml > ice_nml.tex

\newcommand{\link}[2]{\href{https://github.com/mom-ocean/MOM5/search?q=#1}{#2}}

\TODO{work out which ice nmls are relevant}
\TODO{show all namelist entries, not just diff}
{\tiny
\input{ocean_nml.tex}
\input{atm_nml.tex}
\input{ice_nml.tex}
}
\bibliographystyle{ametsoc2014}
\bibliography{ACCESS-OM2-1-025-010deg}

\end{document}  